{"version":3,"sources":["webpack:///webpack/bootstrap 802f1ad0bc57aef348d6","webpack:///./src/dictator.js"],"names":[],"mappings":"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","file":"dictator.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 802f1ad0bc57aef348d6\n **/","let start = function() {\n  let args = (arguments.length === 1?[arguments[0]]:Array.apply(null, arguments));\n  let func = args.shift();\n  try {\n    console.log(['started ->', func.name, args]);\n    func(args);\n  }\n  catch(exception) {\n    console.error([\"Some Exception\", exception]);\n  }\n}\nlet mobileDetection = function() {\n  let md = new MobileDetect(window.navigator.userAgent);\n  if (md.mobile() === null) {\n    $('.only-ios').hide();\n    $('.only-android').hide();\n  }\n\n  if (md.os() === \"AndroidOS\") {\n    $('.only-ios').hide();\n  }\n\n  if (md.os() === \"iOS\") {\n    $('.only-android').hide();\n  }\n  return true;\n};\nlet phoneNumberForm = function() {\n  const DB = new Firebase('https://food-dictator.firebaseio.com/');\n  let currentTeam = '';\n  let currentUser;\n  let electionInterval;\n\n  let setup = function() {\n    $(\"#phone-number\").mask(\"(999) 999-9999\",{placeholder:\" \"});\n    $('#phone-number').on('keyup', _.debounce(watchPhoneNumberInput, 500));\n    $('#phone-number').val(\"\");\n    $(\"#personal-div\").hide();\n    $(\"#loading-indicator\").hide();\n    makeElectionsUnavailable();\n  };\n  let keyIsNumber = function(code) {\n    let bool = false;\n    if (code >= 48 && code <= 57) {\n      bool = true; // desktop keys for numbers\n    }\n    if (code == 229) {\n      bool = true; // Android numberpad\n    }\n    return bool;\n  };\n  let watchPhoneNumberInput = function(evt) {\n    let num = $(evt.target).val().replace(/\\D/g,'');\n    if (num.length === 10 && keyIsNumber(evt.keyCode)) {\n      lookupPhoneNumber(num);\n    }\n    if (num.length < 10) {\n      resetPersonalForm();\n    }\n  };\n  let resetPersonalForm = function() {\n    $(\"#personal-div\").hide();\n    $(\"#election-btn-row\").hide();\n    $(\"#personal-div input[type=text]\").val('');\n    $(\"#phone-div\").removeClass(\"col-lg-push-2\");\n    $(\"#phone-div\").addClass(\"col-lg-push-4 col-md-push-3\");\n  }\n  let showPersonalForm = function(snap) {\n    $(\"#loading-indicator\").hide();\n    $(\"#personal-div\").show();\n    scrollTo('#personal-div');\n    $(\"#phone-div\").addClass(\"col-lg-push-2\");\n    $(\"#phone-div\").removeClass(\"col-lg-push-4 col-md-push-3\");\n    let data = snap.val();\n    if (data !== null) {\n      $(\"#username\").val(data.name);\n      $(\".username-help.new\").hide();\n      if (data.team !== \"alone\" && data.team.trim() !== '') {\n        $(\"#teamname\").val(data.team);\n\n        $(\".teamname-help.new\").hide();\n        makeElectionsAvailable(data.team);\n      }\n    } else {\n      $(\".help.existing\").hide();\n      $(\"#personal-div #username\").focus();\n    }\n    watchForPersonalChanges();\n  };\n  let lookupPhoneNumber = function(num) {\n    $(\"#loading-indicator\").show();\n    scrollTo('#loading-indicator');\n    let userRef = DB.child('/users/1'+num);\n    userRef.once('value', function(snap) {\n      currentUser = num;\n      if (snap.val() !== null) {\n        showPersonalForm(snap);\n        currentTeam = snap.val().team;\n      }\n    });\n  };\n  let watchForPersonalChanges = function() {\n    $(\"#personal-div #teamname\").focus(function() {\n      makeElectionsUnavailable();\n    });\n    $(\"#personal-div form input\").on('keyup', _.debounce(updatePersonalData, 1500));\n  }\n  let updatePersonalData = function() {\n    makeElectionsUnavailable();\n    currentTeam = $(\"#teamname\").val().trim().toLowerCase();\n    DB.child(\"/users/1\"+currentUser+'/name').set($(\"#username\").val().trim());\n    if (currentTeam.length >= 3) {\n      DB.child(\"/users/1\"+currentUser+'/team').set(currentTeam);\n      DB.child(\"/users/1\"+currentUser+'/state').set('member', function(error) {\n        if (!error) {\n          makeElectionsAvailable(currentTeam);\n        }\n      });\n    }\n  };\n  let makeElectionsAvailable = function(team) {\n    $(\".teamname\").text(team);\n    DB.child(\"/teams/\"+team).once('value', function(snap) {\n      console.log(['makeElectionsAvailable',snap.val()]);\n      if (snap.val().state === 'awaiting') {\n        setUpElectionStart();\n      } else {\n        watchRunningElection();\n      }\n    });\n  };\n  let makeElectionsUnavailable = function() {\n    $(\"#election-btn-row\").hide();\n    $(\"#running\").hide();\n  };\n  let setUpElectionStart = function() {\n    $(\"#running\").hide();\n    $(\"#election-btn-row\").show();\n    $(\"#election-btn-row .btn-primary\").click(function(evt) {\n      evt.preventDefault();\n      DB.child(\"/teams/\"+currentTeam+\"/state\").set(\"campaign\");\n      DB.child(\"/users/1\"+currentUser+'/state').set('running', function(error) {\n        if (!error) {\n          watchRunningElection(currentTeam);\n        }\n      });\n    });\n  };\n  let watchRunningElection = function(team) {\n    $(\"#running\").show();\n    $(\"#election-btn-row\").hide();\n    // scrollTo('#running');\n    setupResetButton();\n    console.log(['watchRunningElection', team]);\n    electionInterval = setInterval(getElectionStatus, 1000);\n  };\n  let getElectionStatus = function() {\n    DB.child('users').once('child_changed', function(snap) {\n      if (snap.val().team === currentTeam) {\n        buildElectionStatus(buildElectionObj(snap));\n      }\n    });\n  };\n  let buildElectionObj = function(snap) {\n    let guys = {};\n    let addSnap = function(snap) {\n      guys[snap.key()] = snap.val();\n      return guys;\n    }\n    return addSnap(snap);\n  };\n  let buildElectionStatus = function(obj) {\n    var data = _.map(obj, function(o) {\n      let state = o.state;\n      let cssclass = 'normal';\n      if (o.state === 'dictator') {\n        state = '<strong>'+o.state+'</strong>';\n        cssclass = 'winner';\n      }\n      return \"<h3 class='\" + cssclass +\"'><em>\"+o.name+\"</em> - \"\n        + o.state +\"</h3>\";\n    });\n    $(\"#running .dat-status\").html(data);\n  }\n  let setupResetButton = function() {\n    $(\"#reset\").click(function(evt) {\n      scrollTo('#phone-div');\n      evt.preventDefault();\n      clearInterval(electionInterval);\n      DB.child(\"/teams/\"+currentTeam+\"/state\").set(\"awaiting\");\n      setUpElectionStart();\n    });\n  };\n\n  setup();\n}\nlet scrollTo = function(id) {\n  $('html, body').stop().animate({\n      scrollTop: ($(id).offset().top - 50)\n  }, 300, 'easeInOutExpo');\n}\n\n\n\n$(document).ready(function() {\n  start(mobileDetection);\n  start(phoneNumberForm);\n});\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/dictator.js\n **/"],"sourceRoot":""}